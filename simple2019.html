<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 15px;
            background: #0078d4;
            color: white;
            text-align: center;
        }
        
        .button {
            background: #ff4757;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 5px;
            width: 90%;
        }
        
        .button:hover {
            background: #ff3838;
        }
        
        .status {
            margin-top: 10px;
            font-size: 12px;
        }
        
        #googleFrame {
            width: 100%;
            height: 300px;
            border: none;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <h3>üìß Email Logger</h3>
    <button class="button" onclick="logEmail()">LOG THIS EMAIL</button>
    <button class="button" onclick="showGoogle()">SHOW GOOGLE</button>
    <button class="button" onclick="testAddin()">TEST ADD-IN</button>
    <button class="button" onclick="getEmailInfo()">GET EMAIL INFO</button>
    <div id="status" class="status">Ready to log emails!</div>
    
    <!-- This will show Google inside the add-in -->
    <iframe id="googleFrame" src="about:blank"></iframe>

    <script>
        Office.initialize = function (reason) {
            document.getElementById('status').innerHTML = "‚úÖ Add-in loaded successfully!";
        };

        function logEmail() {
            document.getElementById('status').innerHTML = "üì§ Logging email...";
            
            setTimeout(() => {
                document.getElementById('status').innerHTML = "‚úÖ Email logged! (Demo mode)";
            }, 1000);
        }

        function showGoogle() {
            document.getElementById('status').innerHTML = "üåê Loading Google in add-in...";
            
            // Show Google inside the add-in pane
            var frame = document.getElementById('googleFrame');
            frame.src = 'https://www.google.com';
            frame.style.display = 'block';
            
            document.getElementById('status').innerHTML = "‚úÖ Google loaded below!";
        }

        function testAddin() {
            document.getElementById('status').innerHTML = "üß™ Testing add-in features...";
            
            try {
                if (Office && Office.context && Office.context.mailbox) {
                    var userEmail = Office.context.mailbox.userProfile.emailAddress;
                    var userName = Office.context.mailbox.userProfile.displayName;
                    
                    document.getElementById('status').innerHTML = 
                        "‚úÖ Working! User: " + userName + " (" + userEmail + ")";
                } else {
                    document.getElementById('status').innerHTML = "‚ö†Ô∏è Office.js not fully loaded";
                }
            } catch (error) {
                document.getElementById('status').innerHTML = "‚ùå Error: " + error.message;
            }
        }

        function getEmailInfo() {
            document.getElementById('status').innerHTML = "üìã Getting email info...";
            
            try {
                var item = Office.context.mailbox.item;
                
                if (item && item.subject) {
                    item.subject.getAsync(function(result) {
                        if (result.status === Office.AsyncResultStatus.Succeeded) {
                            var subject = result.value || "No subject";
                            document.getElementById('status').innerHTML = 
                                "üìù Subject: " + subject;
                        } else {
                            document.getElementById('status').innerHTML = "‚ö†Ô∏è Could not get subject";
                        }
                    });
                } else {
                    document.getElementById('status').innerHTML = "‚ö†Ô∏è No email item available (try composing an email)";
                }
            } catch (error) {
                document.getElementById('status').innerHTML = "‚ùå Error getting email: " + error.message;
            }
        }
    </script>
</body>
</html>
